cls 

Connection-Test

$Test = Get-Content -path "C:\Wright\RequiresPush.txt"

Function Restart-Computers {

    [System.Windows.MessageBox]::Show('This computer is sheduled to restart in approximately 10 minutes. Please save your work and have a wonderful day!','Scheduled Computer Restart')
    Start-Sleep -Seconds 600
    Restart-Computer -Force

}

foreach($PC in $Test) {

   Invoke-Command -ComputerName $PC ${Function:Restart-Computers} -AsJob

}
